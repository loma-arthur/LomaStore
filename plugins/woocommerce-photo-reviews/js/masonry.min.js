function wcpr_resize_masonry_items(){jQuery(".wcpr-grid-loadmore .wcpr-grid-item:not(.wcpr-grid-item-init)").each(function(){wcpr_resize_masonry_item(jQuery(this))})}function wcpr_resize_masonry_item(e){e=jQuery(e);let t,i,r=0,n=parseInt(jQuery(".wcpr-grid").data("wcpr_columns")||3);if(e.find(".reviews-images-wrap-right .reviews-images").length&&0===(r=(t=e.find(".reviews-images-wrap-right .reviews-images")).outerHeight())){i=e.find(".wcpr-content").outerWidth();let a=parseFloat(t.attr("width")||0),o=parseFloat(t.attr("height")||0);0===i&&(i=((jQuery(".wcpr-grid").outerWidth()?jQuery(".wcpr-grid").outerWidth():jQuery("#reviews").outerWidth()?jQuery("#reviews").outerWidth():jQuery(".woocommerce-Tabs-panel").outerWidth()?jQuery(".woocommerce-Tabs-panel").outerWidth():200)-20*(n-1))/n),r=0!==o?Math.round(i/a*o):i}let a=e.find(".wcpr-content").outerHeight(),o=e.find(".review-content-container").outerHeight();if(0===o){i||0===(i=e.find(".wcpr-content").outerWidth())&&(i=((jQuery(".wcpr-grid").outerWidth()?jQuery(".wcpr-grid").outerWidth():jQuery("#reviews").outerWidth()?jQuery("#reviews").outerWidth():jQuery(".woocommerce-Tabs-panel").outerWidth()?jQuery(".woocommerce-Tabs-panel").outerWidth():200)-20*(n-1))/n),jQuery("body").append('<div class="review-content-container-temp" style="width: '+i+'px; visibility: hidden; ">'+e.find(".review-content-container").html()+"</div>");let t=jQuery(".review-content-container-temp");t.find(".wcpr-review-content-full").remove(),o=t.outerHeight(),t.remove()}a<o+r&&(a=o+r);let s=Math.ceil((a+20)/21);e.addClass("wcpr-grid-item-init").css("grid-row-end","span "+s)}jQuery(document).ready(function(e){"use strict";let t=!1;/iPad/i.test(navigator.userAgent)||/Safari/i.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&!/Mobi|Android/i.test(navigator.userAgent)?t=!0:e(".wcpr-enable-box-shadow").addClass("wcpr-fix-box-shadow");let i,r=-1,n=0;function a(){let t=parseInt(e("html").css("top"));e("html").removeClass("wcpr-noscroll"),e("html,body").scrollTop(-t)}function o(t){n=0,r=t,t>=i.length&&(r=0),t<0&&(r=i.length-1);let a=e("#reviews-content-left-modal"),o=e("#reviews-content-left-main"),s=e(".wcpr-grid");if(a.html(""),o.html(""),0===s.find(".wcpr-grid-item").eq(r).find(".reviews-images-container").length)e(".wcpr-modal-light-box").addClass("wcpr-no-images");else{a.html(s.find(".wcpr-grid-item").eq(r).find(".reviews-images-wrap-left").html());let t=s.find(".wcpr-grid-item").eq(r).find(".reviews-images-wrap-right").html();t&&(e(".wcpr-modal-light-box").removeClass("wcpr-no-images"),o.html(t)),a.find(".reviews-images").map(function(){let t=e(this).data("src");t&&e(this).attr("src",t)}),a.find(".reviews-images").closest("a").on("click",function(){n=e(this).data("image_index");let t=e(this).attr("href");return o.find("source").attr("srcset",t),o.find(".reviews-images").attr("src",t),o.find(".wcpr-review-image-caption").html(e(this).data("image_caption")),!1})}e("#reviews-content-right .reviews-content-right-meta").html(s.find(".wcpr-grid-item").eq(r).find(".review-content-container").html()),e(".wcpr-modal-light-box").fadeIn(200)}switch(woocommerce_photo_reviews_params.masonry_popup){case"review":e(".wcpr-grid-item")&&(i=e(".wcpr-grid-item")),e(".wcpr-close").on("click",function(){a(),e(".wcpr-modal-light-box").fadeOut(200),r=-1}),e(".wcpr-modal-light-box .wcpr-overlay").on("click",function(){a(),e(".wcpr-modal-light-box").fadeOut(200),r=-1}),e("#reviews-content-left-main").on("click",".reviews-images",function(){let t=e(this),i=[];e("#reviews-content-left-modal").find("a").map(function(){let t=e(this).find(".reviews-images"),r=e(this).data("image_src")?e(this).data("image_src"):t.attr("src"),n=e(this).data("image_caption")?e(this).data("image_caption"):parseInt(e(this).data("image_index"))+1+"/"+e("#reviews-content-left-modal").find("a").length;i.push({href:r,title:n})}),0==i.length&&i.push({href:t.data("original_src")?t.data("original_src"):t.attr("src"),title:t.parent().find(".wcpr-review-image-caption").html()}),e.swipebox(i,{hideBarsDelay:1e5,initialIndexOnArray:n})}),e(document).keydown(function(t){e.swipebox.isOpen||"none"!=e(".wcpr-modal-light-box").css("display")&&(27==t.keyCode&&(a(),e(".wcpr-modal-light-box").fadeOut(200),r=-1),-1!=r&&(37==t.keyCode&&o(r-=1),39==t.keyCode&&o(r+=1)))}),e(document).on("click",".wcpr-grid-item",function(){let t=(i=e(".wcpr-grid-item")).index(e(this));t>=0&&(o(t),function(){if(e(document).height()>e(window).height()){let t=e("html").scrollTop()?e("html").scrollTop():e("body").scrollTop();e("html").addClass("wcpr-noscroll").css("top",-t)}}())}),e(".wcpr-next").on("click",function(){o(r+=1)}),e(".wcpr-prev").on("click",function(){o(r-=1)});break;case"image":e(document).on("click",".wcpr-grid-item .reviews-images",function(t){let i=e(this);t.stopPropagation();let r=i.closest(".reviews-images-container"),n=[];r.find(".reviews-images-wrap-left").find("a").map(function(){let t=e(this).find(".reviews-images"),i=e(this).data("image_src")?e(this).data("image_src"):t.attr("src"),a=e(this).data("image_caption")?e(this).data("image_caption"):parseInt(e(this).data("image_index"))+1+"/"+r.find(".reviews-images-wrap-left").find("a").length;n.push({href:i,title:a})}),0==n.length&&n.push({href:i.data("original_src")?i.data("original_src"):i.attr("src"),title:i.parent().find(".wcpr-review-image-caption").html()}),e.swipebox(n,{hideBarsDelay:1e5,initialIndexOnArray:0})})}return jQuery(document.body).on("wcpr_ajax_load_more_reviews_end wcpr_ajax_pagination_end",function(){setTimeout(function(){wcpr_resize_masonry_items()},100)}),jQuery(document.body).on("click",".wcpr-read-more",function(t){t.stopPropagation();let i=e(this).closest(".wcpr-review-content"),r=i.find(".wcpr-review-content-full").html();r&&i.html(r),i.closest(".wcpr-grid-item").removeClass("wcpr-grid-item-init"),wcpr_resize_masonry_items()}),!1}),jQuery(window).on("load",function(){wcpr_resize_masonry_items()}).on("resize",function(){wcpr_resize_masonry_items()});